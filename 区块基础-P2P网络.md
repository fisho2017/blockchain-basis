# 区块基础-P2P网络

标签（空格分隔）： 磨链入门区块链

在读一些区块链技术介绍文章中，一般都会看到P2P网络这个词汇，这里对P2P和区块链中P2P网络作一个简要说明。
P2P（peer to peer）：这个peer中文翻译就是对等、对等者、伙伴、对端的意思。所以P2P网络一般叫做对等网络，其确切定义：网络中每个参与节点共享节点所拥有的一部分计算能力、存储能力、网络连接能力，这些能力或者称为共享资源通过网络提供的服务和内容，可被对等节点直接访问，访问过程中不需要再经过中间实体，所以每个节点既是资源和服务的使用者、又是整个资源和服务的提供者。P2P网络中各个节点都是出于一个对等的地位，没有主、从的区分，联系实际环境，你目前在操作的一台电脑终端既可以作为服务器。又可以作为终端去获取对等节点的资源。整个网络中不存在中心节点，每个节点都可对任意对等节点做出响应，提供资源，包括计算资源、存储资源等。
P2P不是一个新的技术，早在2000年该模型就已出现，他于传统的客户端/服务器（Client/Server）结构（也就是WWW所采用的结构方式）的一个本质区别是，整个网络结构中不存在中心节点（或中心服务器）。这和区块链的去中心化概念完全契合。

 ![31.jpg-20.7kB][1]

 第一个图示P2P网路和传统架构的区别，对比区块链网络结构，很相似。
P2P的理念，“我为人人、人人为我”让所有加入互联网的人，直接通过互联网交互，不需要一个中间商，这样沟通，共享，交互更加自由和方便，最终把互联网的权利交换给用户，而不是一些集中网络中心。
用过BT下载的同学肯定印象很深刻，种子的多少很大程度上决定了你的下载速度，P2P网络的一大特点区别于传统网络架构中，网络中的资源和服务分散在所有节点上，信息的传输和服务的实现都直接在节点之间进行，可以无需中间环节和服务器的介入，避免了可能的瓶颈。P2P的非中心化基本特点，带来了其在可扩展性、健壮性等方面的优势。在P2P网络中，随着用户的加入，不仅服务的需求增加了，系统整体的资源和服务能力也在同步地扩充，始终能比较容易地满足用户的需要。理论上其可扩展性几乎可以认为是无限的。例如：在传统的通过FTP的文件下载方式中，当下载用户增加之后，下载速度会变得越来越慢，然而P2P网络正好相反，加入的用户越多，P2P网络中提供的资源就越多，下载的速度反而越快。P2P架构天生具有耐攻击、高容错的优点。由于服务是分散在各个节点之间进行的，部分节点或网络遭到破坏对其它部分的影响很小。P2P网络一般在部分节点失效时能够自动调整整体拓扑，保持其它节点的连通性。P2P网络通常都是以自组织的方式建立起来的，并允许节点自由地加入和离开。在P2P网络中，由于信息的传输分散在各节点之间进行而无需经过某个集中环节，用户的隐私信息被窃听和泄漏的可能性大大缩小。此外，目前解决Internet隐私问题主要采用中继转发的技术方法，从而将通信的参与者隐藏在众多的网络实体之中。在传统的一些匿名通信系统中，实现这一机制依赖于某些中继服务器节点。而在P2P中，所有参与者都可以提供中继转发的功能，因而大大提高了匿名通讯的灵活性和可靠性，能够为用户提供更好的隐私保护。
以上这些P2P特点阅读后发现和区块链的特点有众多相似，区块链技术在前文中就提到他是前人各种技术结合后产生的一种新的架构，很好的结合了之前那些技术的特点，实现了多种组合后公共的优良性。
P2P的网络拓扑结构（这个网上很多资料，我基本参考转载于：http://www.intsci.ac.cn/users/luojw/P2P/ch02.html）
中心化拓扑（Centralized Topology）；

 ![32.jpg-16.9kB][2]

中心化拓扑中，网络主体由一个处于中心地位的索引目录服务器连接到目录服务器和各网络节点中。这种方式维护简单，资源发现率高，可实现复杂查询，但容易出现单点故障。

 

分布式P2P网络拓扑包括：全分布式非结构化拓扑（Decentralized Unstructured Topology）；全分布式结构化拓扑（Decentralized Structured Topology，也称作DHT网络）；
![33.jpg-12.4kB][3]
全分布式非结构化拓扑的P2P网络是在重叠网络（Overlay Network）采用了随机图的组织方式，结点度数服从Power-law规律，从而能够较快发现目的结点，面对网络的动态变化体现了较好的容错能力，因此具有较好的可用性。同时可以支持复杂查询。
全分布式结构化拓扑的P2P网络主要是采用分布式散列表（Distributed Hash Table, 简写成DHT）技术来组织网络中的结点。DHT是一个由广域范围大量结点共同维护的巨大散列表。散列表被分割成不连续的块，每个结点被分配给一个属于自己的散列块，并成为这个散列块的管理者。通过加密散列函数，一个对象的名字或关键词被映射为128位或160位的散列值。分布式散列表起源于SDDS（Scalable Distribute Data Structures）研究，Gribble等实现了一个高度可扩展，容错的SDDS集群。DHT类结构能够自适应结点的动态加入/退出，有着良好的可扩展性、鲁棒性、结点ID分配的均匀性和自组织能力。由于重叠网络采用了确定性拓扑结构，DHT可以提供精确的发现。只要目的结点存在于网络中DHT总能发现它，发现的准确性得到了保证。
半分布式拓扑（Partially Decentralized Topology）
![34.jpg-19.9kB][4]
吸取了中心化结构和全分布式非结构化拓扑的优点，选择性能较高（处理、存储、带宽等方面性能）的结点作为超级结点（英文表达为SuperNodes或者Hubs），在各个超级结点上存储了系统中其他部分结点的信息，发现算法仅在超级结点之间转发，超级结点再将查询请求转发给适当的叶子结点。半分布式结构也是一个层次式结构，超级结点之间构成一个高速转发层，超级结点和所负责的普通结点构成若干层次。

实际应用中这4种P2P各有优缺点：
![35.jpg-17.7kB][5]
那区块链技术模型中，一般都认可有一个网络层，在这一层，通过P2P组网机制，数据传播和验证机制来保证，所以P2P网络是区块链的基础，也是组成区块链技术的重要一环。区块链系统建立在IP通信协议和分布式网络的基础上，不依赖传统的电路交换，而是建立与网络通信之上，完全通过互联网交易信息。网络中的节点对等，没有中心化和层级概念，每个节点都承担维护网络路由、验证数据区块的功能。


  [1]: http://static.zybuluo.com/JackyJin/bs9bjscmwc5qm1ls0qyke85x/31.jpg
  [2]: http://static.zybuluo.com/JackyJin/wk953x31thzzdshjxpoi981k/32.jpg
  [3]: http://static.zybuluo.com/JackyJin/who540m3obyrqxw23gf30yp1/33.jpg
  [4]: http://static.zybuluo.com/JackyJin/4qy7l9sms2tyqno9oo2ab265/34.jpg
  [5]: http://static.zybuluo.com/JackyJin/c09k6y0m7v5cjteuerodfcq9/35.jpg